<!DOCTYPE html>
<html xmlns:v-on="http://www.w3.org/1999/xhtml">

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>壹栈管理平台 | 登录</title>

    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="font-awesome/css/font-awesome.css" rel="stylesheet">
    <link href="css/animate.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">


</head>

<body class="gray-bg">

    <div class="middle-box text-center loginscreen animated fadeInDown" @keyup.enter="login">
        <div>
            <div>

                <h1 class="logo-name">壹栈</h1>

            </div>
            <p>         </p>
            <h3>欢迎登陆壹栈平台</h3>
            <form class="m-t" role="form" id="login" v-on:submit.prevent="login">
                <div class="form-group" :class="usernameError">
                  <label class="control-label">{{usernameErrorMsg}}</label>
                  <input type="text"  v-model="username" class="form-control" placeholder="用户名" required="">
                </div>
                <div class="form-group" :class="passwordError">
                      <label class="control-label">{{passwordErrorMsg}}</label>
                    <input type="password"  v-model="password" class="form-control" placeholder="密码" required="">
                </div>
                <button type="submit"  class="ladda-button ladda-button-demo btn btn-primary block full-width m-b" data-style="zoom-in">登录</button>

                <a href="#"><small>忘记密码?</small></a>
            </form>
            <p class="m-t"> <small>壹栈网络管理平台版权所有 &copy; 2017</small> </p>
        </div>
    </div>

    <!-- Mainly scripts -->
    <script src="js/jquery-3.1.1.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/vue.js"></script>
    <script src="js/axios.js"></script>



</body>
<script>
    var vm = new Vue({
        el: "#login",
        data: {
            username: "",
            password: "",
            usernameError:"",
            usernameErrorMsg:"",
            passwordError:"",
            passwordErrorMsg:""
        },
        methods: {
            login: function () {
                var vm = this;
                this.usernameError="";
                this.passwordError="";
                this.usernameErrorMsg="",
                this.passwordErrorMsg="",
                axios.post('http://mapleran.iask.in:8888/user/login.do',{
                  username:vm.username,
                  password:vm.password
                })
                .then(function(response){
                    if (response.data.status===0) {
                      window.location.href="http://mapleran.iask.in:8888/sfv/data_report.html";
                    }else {
                      if (response.data.msg==="用户不存在") {
                        vm.usernameError="has-error";
                        vm.usernameErrorMsg=response.data.msg;
                      }else if (response.data.msg==="密码错误") {
                        vm.passwordError="has-error";
                        vm.passwordErrorMsg=response.data.msg;
                      }
                    }
                }).catch(function(err){
                  console.log(err);
                })

            }
        }

    });


</script>

</html>
